[validate] Warning: could not load stage config: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.collectAndServe.
: org.apache.hadoop.mapred.InvalidInputException: Input path does not exist: s3://darkhaloscope/phase4_pipeline/phase4a/v3_color_relaxed/_stage_config.json
	at org.apache.hadoop.mapred.FileInputFormat.singleThreadedListStatus(FileInputFormat.java:270)
	at org.apache.hadoop.mapred.FileInputFormat.listStatus(FileInputFormat.java:216)
	at org.apache.hadoop.mapred.FileInputFormat.getSplits(FileInputFormat.java:298)
	at org.apache.spark.rdd.HadoopRDD.getPartitions(HadoopRDD.scala:208)
	at org.apache.spark.rdd.RDD.$anonfun$partitions$2(RDD.scala:291)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:287)
	at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:49)
	at org.apache.spark.rdd.RDD.$anonfun$partitions$2(RDD.scala:291)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.rdd.RDD.partitions(RDD.scala:287)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2331)
	at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1019)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)
	at org.apache.spark.rdd.RDD.withScope(RDD.scala:405)
	at org.apache.spark.rdd.RDD.collect(RDD.scala:1018)
	at org.apache.spark.api.python.PythonRDD$.collectAndServe(PythonRDD.scala:193)
	at org.apache.spark.api.python.PythonRDD.collectAndServe(PythonRDD.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.io.IOException: Input path does not exist: s3://darkhaloscope/phase4_pipeline/phase4a/v3_color_relaxed/_stage_config.json
	at org.apache.hadoop.mapred.FileInputFormat.singleThreadedListStatus(FileInputFormat.java:250)
	... 30 more

[validate] Reading manifests from 3 path(s): ['s3://darkhaloscope/phase4_pipeline/phase4a/v3_color_relaxed/manifests/debug_stamp64_bandsgrz_gridgrid_small/', 's3://darkhaloscope/phase4_pipeline/phase4a/v3_color_relaxed/manifests/grid_stamp64_bandsgrz_gridgrid_medium/', 's3://darkhaloscope/phase4_pipeline/phase4a/v3_color_relaxed/manifests/train_stamp64_bandsgrz_gridgrid_small/']
[validate] Loaded manifests from s3://darkhaloscope/phase4_pipeline/phase4a/v3_color_relaxed/manifests/debug_stamp64_bandsgrz_gridgrid_small/,s3://darkhaloscope/phase4_pipeline/phase4a/v3_color_relaxed/manifests/grid_stamp64_bandsgrz_gridgrid_medium/,s3://darkhaloscope/phase4_pipeline/phase4a/v3_color_relaxed/manifests/train_stamp64_bandsgrz_gridgrid_small/
[validate] Manifest columns: ['task_id', 'experiment_id', 'selection_set_id', 'selection_strategy', 'ranking_mode', 'region_id', 'region_split', 'brickname', 'ra', 'dec', 'zmag', 'rmag', 'w1mag', 'rz', 'zw1', 'psfsize_r', 'psfdepth_r', 'ebv', 'psf_bin', 'depth_bin', 'config_id', 'theta_e_arcsec', 'src_dmag', 'src_reff_arcsec', 'src_e', 'shear', 'stamp_size', 'bandset', 'replicate', 'is_control', 'task_seed64', 'src_x_arcsec', 'src_y_arcsec', 'src_phi_rad', 'shear_phi_rad', 'src_gr', 'src_rz', 'lens_model', 'lens_e', 'lens_phi_rad', 'ab_zp_nmgy', 'pipeline_version']
[validate] Loaded bricks_manifest from s3://darkhaloscope/phase4_pipeline/phase4a/v3_color_relaxed/bricks_manifest/
[validate] Key column null check: PASSED
[validate] Row counts by tier/split:
  tier=debug, split=test: 5,760
  tier=debug, split=train: 5,760
  tier=debug, split=val: 5,760
  tier=grid, split=test: 344,880
  tier=grid, split=train: 330,480
  tier=grid, split=val: 345,600
  tier=train, split=test: 3,681,570
  tier=train, split=train: 2,768,516
  tier=train, split=val: 4,198,484
[validate] Minimum row count check: PASSED
[validate] Control fraction by tier/split:
  tier=debug, split=test: observed=0.000, expected~0.000 [OK]
  tier=debug, split=train: observed=0.000, expected~0.000 [OK]
  tier=debug, split=val: observed=0.000, expected~0.000 [OK]
  tier=grid, split=test: observed=0.109, expected~0.100 [OK]
  tier=grid, split=train: observed=0.089, expected~0.100 [OK]
  tier=grid, split=val: observed=0.119, expected~0.100 [OK]
  tier=train, split=test: observed=0.499, expected~0.250 [WARN]
    WARNING: Control fraction mismatch exceeds tolerance 0.05
  tier=train, split=train: observed=0.499, expected~0.250 [WARN]
    WARNING: Control fraction mismatch exceeds tolerance 0.05
  tier=train, split=val: observed=0.498, expected~0.250 [WARN]
    WARNING: Control fraction mismatch exceeds tolerance 0.05
[validate] theta_e range: [-0.0000, 1.2000] arcsec - PASSED
[validate] Control/non-control theta_e consistency: PASSED
[validate] Frozen randomness columns for non-controls: PASSED
[validate] shear_phi_rad range: PASSED
[validate] src color ranges: PASSED
[validate] Bricks manifest: 180373 unique bricks
[validate] O(n_cfg^2) explosion check: PASSED
[validate] Lens parameter consistency: PASSED

============================================================
OK: Phase 4a manifests and bricks_manifest passed validation.
============================================================
